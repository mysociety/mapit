Thanks to Matthew Somerville for advice on fixing this
